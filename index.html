<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ãƒ¯ãƒ‹ã‚­ãƒ£ãƒƒãƒã‚²ãƒ¼ãƒ </title>

<style>
body {
    margin: 0;
    background: #000;
    overflow: hidden;
    touch-action: none;
    color: #fff;
    font-family: sans-serif;
}

/* ãƒ¯ãƒ‹ã‚­ãƒ£ãƒ©ï¼ˆå¯æ„›ã„PNGã«å¤‰æ›´æ¸ˆã¿ï¼‰ */
#player {
    position: absolute;
    bottom: 5vh;
    left: 50%;
    transform: translateX(-50%);
    width: 150px;
    pointer-events: none;
}

/* è½ã¡ç‰© */
.item {
    position: absolute;
    top: -150px;
    width: 130px;
    height: 130px;
    font-size: 100px;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* UI */
#score, #timer {
    position: absolute;
    left: 10px;
    font-size: 28px;
}
#timer { top: 40px; }

/* ãƒªã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ */
#restart {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translateX(-50%);
    padding: 20px 40px;
    font-size: 26px;
    background: #44ccff;
    color: #000;
    border-radius: 15px;
    display: none;
}
</style>
</head>

<body>

<!-- â˜… ãƒ¯ãƒ‹PNGç”»åƒï¼ˆçµ¶å¯¾è¡¨ç¤ºã•ã‚Œã‚‹ï¼‰ -->
<img id="player" src="https://i.imgur.com/qDe7RwZ.png">

<div id="score">Score: 0</div>
<div id="timer">Time: 30</div>
<div id="restart">ã‚‚ã†ä¸€å›ï¼</div>

<script>
let score = 0;
let time = 30;
let running = true;
let intervals = [];

const player = document.getElementById("player");
const restartBtn = document.getElementById("restart");
let playerX = window.innerWidth / 2;

/* ã‚¹ãƒãƒ›&PCæ“ä½œ */
document.addEventListener("touchstart", e => playerX = e.touches[0].clientX);
document.addEventListener("touchmove",  e => playerX = e.touches[0].clientX);
document.addEventListener("mousemove",  e => playerX = e.clientX);

/* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½å¾“ */
intervals.push(setInterval(()=>{
    player.style.left = (playerX - 75) + "px";
}, 16));

/* ãƒ•ãƒ«ãƒ¼ãƒ„ */
const fruits = ["ğŸ","ğŸŒ","ğŸ‡","ğŸ‘","ğŸ“"];

/* è½ä¸‹ç‰©ç”Ÿæˆ */
function spawn(){
    if (!running) return;

    const item = document.createElement("div");
    item.className = "item";

    const isBomb = Math.random() < 0.25;
    item.textContent = isBomb ? "ğŸ’£" : fruits[Math.floor(Math.random()*fruits.length)];

    item.style.left = Math.random() * (window.innerWidth - 130) + "px";
    document.body.appendChild(item);

    let y = -150;

    const fall = setInterval(()=>{
        if (!running){
            clearInterval(fall);
            item.remove();
            return;
        }

        y += 7;
        item.style.top = y + "px";

        // å½“ãŸã‚Šåˆ¤å®š
        const p = player.getBoundingClientRect();
        const b = item.getBoundingClientRect();

        if (
            b.bottom > p.top &&
            b.top < p.bottom &&
            b.right > p.left &&
            b.left < p.right
        ){
            clearInterval(fall);
            item.remove();

            if (isBomb) score--;
            else score++;

            document.getElementById("score").textContent = "Score: " + score;
        }

        if (y > window.innerHeight){
            clearInterval(fall);
            item.remove();
        }
    }, 16);

    intervals.push(fall);
}

/* 0.7ç§’ã”ã¨ã«è½ä¸‹ */
intervals.push(setInterval(spawn, 700));

/* ã‚¿ã‚¤ãƒãƒ¼ */
intervals.push(setInterval(()=>{
    if (!running) return;

    time--;
    document.getElementById("timer").textContent = "Time: " + time;

    if (time <= 0){
        running = false;
        restartBtn.style.display = "block";
    }
}, 1000));

/* ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ */
restartBtn.addEventListener("click", ()=>{
    // å…¨éƒ¨ã‚¯ãƒªã‚¢
    intervals.forEach(i => clearInterval(i));
    document.querySelectorAll(".item").forEach(el => el.remove());

    // åˆæœŸåŒ–
    score = 0;
    time = 30;
    running = true;
    document.getElementById("score").textContent = "Score: 0";
    document.getElementById("timer").textContent = "Time: 30";
    restartBtn.style.display = "none";

    // å†é–‹
    intervals = [];
    intervals.push(setInterval(spawn, 700));
    intervals.push(setInterval(()=>{
        if (!running) return;
        time--;
        document.getElementById("timer").textContent = "Time: " + time;
        if (time <= 0){
            running = false;
            restartBtn.style.display = "block";
        }
    }, 1000));
});
</script>

</body>
</html>
