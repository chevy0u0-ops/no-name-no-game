<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>ãƒ¯ãƒ‹ã®ãƒ•ãƒ«ãƒ¼ãƒ„ã‚­ãƒ£ãƒƒãƒ</title>

<style>
    body {
        margin: 0;
        background: #000;
        overflow: hidden;
        font-family: sans-serif;
        color: #fff;
        text-align: center;
    }

    #score, #timer {
        font-size: 24px;
        margin: 10px;
    }

    #game {
        position: relative;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
    }

    /* ãƒ¯ãƒ‹ã‚­ãƒ£ãƒ© */
    #player {
        position: absolute;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 50px;
        background: #3cb371; /* ç·‘ã‹ã‚ã„ã„è‰² */
        border-radius: 40px;
        border: 3px solid #2e8b57;
    }

    /* ç›®ï¼ˆãƒ¯ãƒ‹é¢¨ã«ï¼‰ */
    .eye {
        position: absolute;
        top: 8px;
        width: 14px;
        height: 14px;
        background: white;
        border-radius: 50%;
    }
    .eye.left { left: 18px; }
    .eye.right { right: 18px; }

    /* ãƒ•ãƒ«ãƒ¼ãƒ„ */
    .fruit {
        position: absolute;
        width: 30px;
        height: 30px;
        border-radius: 50%;
    }

    /* çˆ†å¼¾ */
    .bomb {
        position: absolute;
        width: 30px;
        height: 30px;
        background: #222;
        border-radius: 50%;
        border: 3px solid #555;
    }
</style>
</head>

<body>

<div id="score">ã‚¹ã‚³ã‚¢ï¼š0</div>
<div id="timer">æ®‹ã‚Šï¼š30ç§’</div>
<div id="game"></div>

<script>
const game = document.getElementById("game");

// --- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆãƒ¯ãƒ‹ï¼‰ ---
const player = document.createElement("div");
player.id = "player";

// ç›®ã‚’è¿½åŠ 
const eyeL = document.createElement("div");
eyeL.className = "eye left";
const eyeR = document.createElement("div");
eyeR.className = "eye right";
player.appendChild(eyeL);
player.appendChild(eyeR);

game.appendChild(player);

let score = 0;
let time = 30;

// ã‚¹ã‚³ã‚¢æ›´æ–°
function updateScore() {
    document.getElementById("score").innerText = "ã‚¹ã‚³ã‚¢ï¼š" + score;
}
// ã‚¿ã‚¤ãƒãƒ¼æ›´æ–°
function updateTimer() {
    document.getElementById("timer").innerText = "æ®‹ã‚Šï¼š" + time + "ç§’";
}

// ãƒ•ãƒ«ãƒ¼ãƒ„ä½œæˆ
function createFruit() {
    const f = document.createElement("div");
    f.className = "fruit";

    // ãƒ©ãƒ³ãƒ€ãƒ ã«ç¨®é¡ã¨è‰²
    const colors = ["#ff4757", "#ffa502", "#2ed573", "#1e90ff", "#ff6b81"];
    f.style.background = colors[Math.floor(Math.random() * colors.length)];

    f.style.left = Math.random() * (window.innerWidth - 30) + "px";
    f.style.top = "0px";

    game.appendChild(f);

    fallObject(f, "fruit");
}

// çˆ†å¼¾ä½œæˆ
function createBomb() {
    const b = document.createElement("div");
    b.className = "bomb";
    b.style.left = Math.random() * (window.innerWidth - 30) + "px";
    b.style.top = "0px";

    game.appendChild(b);

    fallObject(b, "bomb");
}

// è½ä¸‹å‡¦ç†
function fallObject(obj, type) {
    const fall = setInterval(() => {
        let t = parseInt(obj.style.top);
        obj.style.top = t + 5 + "px";

        // å½“ãŸã‚Šåˆ¤å®š
        const px = player.getBoundingClientRect();
        const ox = obj.getBoundingClientRect();

        if (
            ox.bottom >= px.top &&
            ox.left < px.right &&
            ox.right > px.left
        ) {
            clearInterval(fall);

            if (type === "fruit") {
                score++;
                updateScore();
            } else {
                alert("ğŸ’¥ ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼ ã‚¹ã‚³ã‚¢ï¼š" + score);
                location.reload();
            }
            obj.remove();
        }

        // ç”»é¢å¤–ã«å‡ºãŸã‚‰å‰Šé™¤
        if (t > window.innerHeight) {
            clearInterval(fall);
            obj.remove();
        }
    }, 20);
}

// ãƒ©ãƒ³ãƒ€ãƒ ã«è½ä¸‹
setInterval(() => {
    if (Math.random() < 0.8) createFruit();
    else createBomb();
}, 700);

// ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•ï¼ˆã‚¹ãƒãƒ›ã‚¿ãƒƒãƒ—ï¼‰
game.addEventListener("touchmove", e => {
    const x = e.touches[0].clientX;
    player.style.left = (x - 40) + "px";
});

// PCç”¨ãƒã‚¦ã‚¹ç§»å‹•
game.addEventListener("mousemove", e => {
    player.style.left = (e.clientX - 40) + "px";
});

// 30ç§’ã‚¿ã‚¤ãƒãƒ¼
const timer = setInterval(() => {
    time--;
    updateTimer();
    if (time <= 0) {
        clearInterval(timer);
        alert("çµ‚äº†ï¼ ã‚¹ã‚³ã‚¢ï¼š" + score);
        location.reload();
    }
}, 1000);
</script>

</body>
</html>
