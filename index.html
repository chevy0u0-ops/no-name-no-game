<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ãƒ¯ãƒ‹ã‚­ãƒ£ãƒƒãƒã‚²ãƒ¼ãƒ </title>

<style>
body {
    margin: 0;
    background: #000;
    overflow: hidden;
    touch-action: none;
    color: #fff;
    font-family: sans-serif;
}

/* ãƒ¯ãƒ‹ï¼šimg ãªã®ã§çµ¶å¯¾è¡¨ç¤ºã•ã‚Œã‚‹ */
#player {
    position: absolute;
    bottom: 5vh;
    left: 50%;
    transform: translateX(-50%);
    width: 140px;
}

/* è½ä¸‹ç‰©ã‚µã‚¤ã‚ºå¤§ãã‚ */
.item {
    position: absolute;
    top: -150px;
    width: 120px;
    height: 120px;
    font-size: 90px;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* UI */
#score, #timer {
    position: absolute;
    left: 10px;
    font-size: 28px;
}
#timer { top: 40px; }
</style>
</head>

<body>

<!-- â˜… ç”»åƒã®ãƒ¯ãƒ‹ï¼ˆçµ¶å¯¾è¡¨ç¤ºã•ã‚Œã‚‹ï¼‰ -->
<img id="player" src="https://i.imgur.com/F0bqC7A.png">

<div id="score">Score: 0</div>
<div id="timer">Time: 30</div>

<script>
let score = 0;
let time = 30;
let running = true;
let intervals = [];

const player = document.getElementById("player");
let playerX = window.innerWidth / 2;

/* ã‚¹ãƒãƒ›ãƒ»PC ä¸¡å¯¾å¿œ ç§»å‹• */
document.addEventListener("touchstart", e => playerX = e.touches[0].clientX);
document.addEventListener("touchmove",  e => playerX = e.touches[0].clientX);
document.addEventListener("mousemove",  e => playerX = e.clientX);

/* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å‹•ã‹ã™ */
intervals.push(setInterval(()=>{
    player.style.left = (playerX - 70) + "px";
}, 16));

const fruits = ["ğŸ","ğŸŒ","ğŸ‡","ğŸ‘","ğŸ“"];

/* è½ä¸‹ç‰©ç”Ÿæˆ */
function spawn(){
    if (!running) return;

    const item = document.createElement("div");
    item.className = "item";

    const isBomb = Math.random() < 0.25;
    item.textContent = isBomb ? "ğŸ’£" : fruits[Math.floor(Math.random()*fruits.length)];

    item.style.left = Math.random() * (window.innerWidth - 120) + "px";
    document.body.appendChild(item);

    let y = -150;

    const fall = setInterval(()=>{
        if (!running){
            clearInterval(fall);
            item.remove();
            return;
        }

        y += 6;
        item.style.top = y + "px";

        // å½“ãŸã‚Šåˆ¤å®š
        const p = player.getBoundingClientRect();
        const b = item.getBoundingClientRect();

        if (
            b.bottom > p.top &&
            b.top < p.bottom &&
            b.right > p.left &&
            b.left < p.right
        ){
            clearInterval(fall);
            item.remove();

            // â˜…ã“ã“ã‚’å¿…ãšãƒã‚¤ãƒŠã‚¹ã®ã¿
            if (isBomb) score--;
            else score++;

            document.getElementById("score").textContent = "Score: " + score;
        }

        if (y > window.innerHeight){
            clearInterval(fall);
            item.remove();
        }
    }, 16);

    intervals.push(fall);
}

/* 0.7ç§’ãŠãã«è½ä¸‹ */
intervals.push(setInterval(spawn, 700));

/* ã‚¿ã‚¤ãƒãƒ¼ */
intervals.push(setInterval(()=>{
    if (!running) return;
    time--;
    document.getElementById("timer").textContent = "Time: " + time;

    if (time <= 0){
        running = false;
        intervals.forEach(i => clearInterval(i)); // å…¨åœæ­¢
    }
}, 1000));
</script>

</body>
</html>
