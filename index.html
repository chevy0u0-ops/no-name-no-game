<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ãƒ¯ãƒ‹ã®ãƒ•ãƒ«ãƒ¼ãƒ„ã‚­ãƒ£ãƒƒãƒ</title>

<style>
    body {
        margin: 0;
        background: #000;
        color: #fff;
        font-family: sans-serif;
        overflow: hidden;
        text-align: center;
    }

    #game {
        position: relative;
        width: 100vw;
        height: 100vh;
    }

    /* â–¼â–¼ ãƒ¯ãƒ‹ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰ â–¼â–¼ */
    #player {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        width: 90px;
        height: 90px;
        background: #6bd66b;
        border-radius: 20px;
        text-align: center;
        line-height: 90px;
        font-size: 48px;
    }

    /* â–¼â–¼ è½ã¡ã¦ãã‚‹ã‚¢ã‚¤ãƒ†ãƒ  â–¼â–¼ */
    .item {
        position: absolute;
        width: 40px;
        height: 40px;
        font-size: 32px;
        text-align: center;
    }

    /* ã‚¹ã‚³ã‚¢ã¨ã‚¿ã‚¤ãƒãƒ¼ */
    #score, #timer {
        font-size: 24px;
        margin-top: 5px;
    }
</style>
</head>

<body>

<div id="score">ã‚¹ã‚³ã‚¢ï¼š0</div>
<div id="timer">æ®‹ã‚Šï¼š30ç§’</div>

<div id="game">
    <div id="player">ğŸŠ</div>
</div>

<script>
    const game = document.getElementById("game");
    const player = document.getElementById("player");

    let score = 0;
    let time = 30;

    function updateScore() {
        document.getElementById("score").innerText = "ã‚¹ã‚³ã‚¢ï¼š" + score;
    }

    function updateTimer() {
        document.getElementById("timer").innerText = "æ®‹ã‚Šï¼š" + time + "ç§’";
    }

    /* â–¼â–¼ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŒ‡ã§å·¦å³ã«å‹•ã‹ã™ â–¼â–¼ */
    game.addEventListener("touchmove", (e) => {
        const x = e.touches[0].clientX;
        player.style.left = x - 45 + "px";
    });

    /* â–¼â–¼ è½ä¸‹ç‰©ã‚’ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ â–¼â–¼ */
    function dropItem() {
        const item = document.createElement("div");
        item.className = "item";

        // 70%ï¼šãƒ•ãƒ«ãƒ¼ãƒ„ã€30%ï¼šçˆ†å¼¾
        const rand = Math.random();
        if (rand < 0.7) {
            item.innerText = "ğŸ"; // ãƒ•ãƒ«ãƒ¼ãƒ„
            item.dataset.type = "fruit";
        } else {
            item.innerText = "ğŸ’£"; // çˆ†å¼¾
            item.dataset.type = "bomb";
        }

        item.style.left = Math.random() * window.innerWidth + "px";
        item.style.top = "-40px";

        game.appendChild(item);

        const fall = setInterval(() => {
            const t = parseInt(item.style.top);
            item.style.top = t + 5 + "px";

            const px = player.getBoundingClientRect();
            const ix = item.getBoundingClientRect();

            // å½“ãŸã‚Šåˆ¤å®š
            if (
                ix.bottom >= px.top &&
                ix.left < px.right &&
                ix.right > px.left
            ) {
                clearInterval(fall);
                
                if (item.dataset.type === "fruit") {
                    score++;
                    updateScore();
                } else {
                    alert("çˆ†å¼¾ã«å½“ãŸã£ãŸï¼\nã‚¹ã‚³ã‚¢ï¼š" + score);
                    location.reload();
                }
                item.remove();
            }

            // ç”»é¢å¤–ã«æ¶ˆãˆãŸã‚‰å‰Šé™¤
            if (t > window.innerHeight) {
                clearInterval(fall);
                item.remove();
            }
        }, 20);
    }

    /* â–¼â–¼ å®šæœŸçš„ã«è½ã¨ã™ â–¼â–¼ */
    setInterval(dropItem, 700);

    /* â–¼â–¼ 30ç§’ã‚¿ã‚¤ãƒãƒ¼ â–¼â–¼ */
    const timer = setInterval(() => {
        time--;
        updateTimer();

        if (time <= 0) {
            clearInterval(timer);
            alert("çµ‚äº†ï¼\nã‚¹ã‚³ã‚¢ï¼š" + score);
            location.reload();
        }
    }, 1000);

</script>

</body>
</html>
