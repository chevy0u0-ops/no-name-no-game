<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Fruit Catch Game</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #f8f5e6;
    }
    #gameCanvas {
        display: block;
        margin: 0 auto;
        background: #e8dfc8;
        touch-action: none;
    }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<script>
// ----- Responsive Canvas -----
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// ã‚¹ãƒãƒ›ã®å¹…ã«è‡ªå‹•ãƒ•ã‚£ãƒƒãƒˆ
function resizeCanvas() {
    canvas.width = window.innerWidth * 0.9;
    canvas.height = window.innerHeight * 0.85;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// ----- Basket -----
const basket = {
    x: canvas.width / 2 - 60,
    y: canvas.height - 120,
    width: 120,
    height: 60,
    speed: 10
};

// ----- Objects -----
const fruitTypes = ["ğŸ", "ğŸŒ", "ğŸ‡", "ğŸ’"];
let objects = [];
let score = 0;
let lastFruit = null;

// ----- Spawn Falling Items -----
function spawnObject() {
    const isBomb = Math.random() < 0.3; // çˆ†å¼¾å¤šã‚
    const size = 55; // ã‚µã‚¤ã‚ºã‚¢ãƒƒãƒ—

    objects.push({
        x: Math.random() * (canvas.width - size),
        y: -60,
        size: size,
        speed: 3 + Math.random() * 2,
        type: isBomb ? "ğŸ’£" : fruitTypes[Math.floor(Math.random() * fruitTypes.length)]
    });
}
setInterval(spawnObject, 650);

// ----- Draw Basket -----
function drawBasket() {
    ctx.fillStyle = "#8b5a2b";
    ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
}

// ----- Draw Objects -----
function drawObjects() {
    ctx.font = "45px serif";
    objects.forEach(obj => {
        ctx.fillText(obj.type, obj.x, obj.y);
    });
}

// ----- Update Objects -----
function updateObjects() {
    for (let i = 0; i < objects.length; i++) {
        let obj = objects[i];
        obj.y += obj.speed;

        // ---- Collision ----
        if (
            obj.y + obj.size > basket.y &&
            obj.x < basket.x + basket.width &&
            obj.x + obj.size > basket.x
        ) {
            if (obj.type === "ğŸ’£") {
                alert("ğŸ’¥ çˆ†å¼¾ã«å½“ãŸã£ãŸï¼ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼\nã‚¹ã‚³ã‚¢: " + score);
                location.reload();
                return;
            }

            score += 5;
            if (obj.type === lastFruit) score += 10;
            lastFruit = obj.type;

            objects.splice(i, 1);
            i--;
        }

        // ---- Out of screen ----
        if (obj.y > canvas.height) {
            objects.splice(i, 1);
            i--;
        }
    }
}

// ----- Score -----
function drawScore() {
    ctx.fillStyle = "#000";
    ctx.font = "24px sans-serif";
    ctx.fillText("Score: " + score, 15, 35);
}

// ----- Game Loop -----
function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    drawBasket();
    drawObjects();
    updateObjects();
    drawScore();

    requestAnimationFrame(gameLoop);
}
gameLoop();

// ----- Controls -----
document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") basket.x -= basket.speed;
